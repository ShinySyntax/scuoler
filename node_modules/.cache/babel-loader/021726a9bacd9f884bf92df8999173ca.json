{"ast":null,"code":"var _jsxFileName = \"/home/mathew/javascript/ischools-react/client/src/components/Header.js\";\nimport React, { Component } from 'react';\nimport FacebookLogin from 'react-facebook-login';\nimport GoogleLogin from 'react-google-login';\nimport configurationLogins from '../ConfigurationLogins';\nimport { getMinutesRemaining } from '../utils/utils';\nimport data from './data';\nimport { userIdChange, passwordChange, setErrorMessage, onLogin, onLogout, submitQuiz } from '../stores/appStoreActions';\n\nclass Header extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleAltLogin = (strSource, response) => {\n      const AltLoginInitiate = (firstName, lastName, email, id, picture_url) => {\n        var reqBody = \"userId=\" + encodeURIComponent(id);\n        reqBody += '&firstName=' + encodeURIComponent(firstName);\n        reqBody += '&lastName=' + encodeURIComponent(lastName);\n        reqBody += '&email=' + encodeURIComponent(email);\n        reqBody += '&pictureUrl=' + encodeURIComponent(picture_url);\n        fetch(`/api/mergeUser`, {\n          headers: {\n            'Accept': 'application/json',\n            'Content-type': 'application/x-www-form-urlencoded'\n          },\n          method: 'POST',\n          body: reqBody\n        }).then(res => res.json()).then(data => {//console.log(data);\n        });\n        onLogin({\n          errorMessage: null,\n          loggedInUser: id,\n          loggedInUserFullName: firstName + ' ' + lastName,\n          admin: '0'\n        }, dispatch); //console.log(firstName+' '+lastName+' '+email+' '+id+' '+picture_url);\n      };\n\n      if (strSource === 'facebook' && response.id !== undefined) {\n        let fullName = response.name;\n        let firstName = fullName;\n        let lastName = \"\";\n        let arrName = fullName.split(\" \");\n\n        if (arrName.length > 1) {\n          firstName = arrName[0];\n          lastName = arrName[1];\n        }\n\n        let email = response.email;\n        let id = response.id;\n        let picture_url = response.picture.data.url;\n        AltLoginInitiate(firstName, lastName, email, id, picture_url);\n      } else if (strSource === 'google' && response.googleId !== undefined) {\n        let id = response.googleId;\n        let picture_url = response.profileObj.imageUrl;\n        let email = response.profileObj.email;\n        let firstName = response.profileObj.givenName;\n        let lastName = response.profileObj.familyName;\n        AltLoginInitiate(firstName, lastName, email, id, picture_url); //console.log(response);\n      } //alert(strSource);\n\n    };\n\n    this.handleLoginSubmit = event => {\n      let globalState = this.props.state;\n      let dispatch = this.props.dispatch;\n\n      if (globalState.userId === null || globalState.password === null || globalState.password.length === 0 || globalState.userId.length === 0) {\n        event.preventDefault();\n        setErrorMessage(\"UserId/password cannot be empty\", dispatch);\n        return;\n      }\n\n      var reqBody = \"userId=\" + encodeURIComponent(globalState.userId);\n      reqBody += '&password=' + encodeURIComponent(globalState.password);\n      fetch(`/api/login`, {\n        headers: {\n          'Accept': 'application/json',\n          'Content-type': 'application/x-www-form-urlencoded'\n        },\n        method: 'POST',\n        body: reqBody\n      }).then(res => res.json()).then(data => {\n        console.log(data);\n\n        if (data.login === \"ok\") {\n          /*localStorage.setItem('loggedInUser', globalState.userId);\n          localStorage.setItem('loggedInUserFullName', data.full_name);\n          localStorage.setItem('admin', data.admin);*/\n          onLogin({\n            errorMessage: null,\n            loggedInUser: globalState.userId,\n            loggedInUserFullName: data.full_name,\n            admin: data.admin\n          }, dispatch);\n        } else {\n          setErrorMessage(\"Login Failed: UserId/password Mismatch\", dispatch);\n        }\n      });\n      event.preventDefault();\n    };\n\n    this.logoutUser = e => {\n      //e.preventDefault();\n      let globalState = this.props.state;\n      let dispatch = this.props.dispatch;\n      let confirmMsg = 'Are you sure you want to logout?';\n\n      if (globalState.startedQuiz !== null) {\n        confirmMsg += 'There is an unsubmitted quiz: \\r\\n' + this.state.startedQuiz.description;\n      }\n\n      let b = window.confirm(confirmMsg);\n\n      if (b === true) {\n        if (globalState.startedQuiz !== null) submitQuiz(globalState, dispatch);\n        /*localStorage.setItem('loggedInUser', '');\n        localStorage.setItem('loggedInUserFullName','');\n        localStorage.setItem('admin', \"0\");\n        localStorage.removeItem('startedQuiz');\n        localStorage.removeItem('startedQuizAnswers');*/\n\n        onLogout({\n          errorMessage: null,\n          loggedInUser: '',\n          admin: \"0\",\n          startedQuiz: null,\n          startedQuizAnswers: null\n        }, dispatch);\n      } else {\n        e.preventDefault();\n      }\n    };\n\n    this.state = {\n      icons: data.icons\n    };\n  }\n\n  render() {\n    let globalState = this.props.state;\n    let dispatch = this.props.dispatch;\n    return globalState.loggedInUser === \"\" ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"Header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      method: \"post\",\n      action: \"login\",\n      onSubmit: event => this.handleLoginSubmit(event),\n      noValidate: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"flexColLeft\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      id: \"logo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 25\n      }\n    }, \"Schools.com\"), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 59\n      }\n    }), globalState.startedQuiz !== null ? /*#__PURE__*/React.createElement(\"label\", {\n      style: {\n        color: 'maroon',\n        textDecoration: 'underline',\n        cursor: 'pointer'\n      },\n      onClick: e => window.location.assign(\"https://\" + window.location.hostname + ':' + window.location.port + \"/quizShowSelected/\" + globalState.startedQuiz.id),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 51\n      }\n    }, /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 51\n      }\n    }), globalState.startedQuiz.description, \" started (\", getMinutesRemaining(globalState.startedQuiz.start_time, globalState.startedQuiz.duration_minutes), \" mins left) \") : null, /*#__PURE__*/React.createElement(\"label\", {\n      style: {\n        color: \"red\",\n        paddingRight: \"50px\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 25\n      }\n    }, globalState.errorMessage)), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"flexColRight\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      id: \"HeaderRightLink\",\n      href: \"/userInsert\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 31\n      }\n    }, \"Register User\"), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 92\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 97\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 102\n      }\n    }), /*#__PURE__*/React.createElement(\"label\", {\n      for: \"userId\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 31\n      }\n    }, \"user id\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      id: \"userName\",\n      name: \"userName\",\n      tabindex: \"1\",\n      onChange: e => userIdChange(e, dispatch),\n      value: globalState.userId,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 31\n      }\n    }), /*#__PURE__*/React.createElement(\"label\", {\n      for: \"password\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 32\n      }\n    }, \"password\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"password\",\n      id: \"password\",\n      name: \"password\",\n      tabindex: \"2\",\n      onChange: e => passwordChange(e, dispatch),\n      value: globalState.password,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 32\n      }\n    }), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"submit\",\n      value: \"Login\",\n      tabindex: \"3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 32\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 81\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 86\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"alt-login-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 32\n      }\n    }, /*#__PURE__*/React.createElement(GoogleLogin, {\n      className: \"alt-login-component\",\n      style: {\n        fontSize: '10pt'\n      },\n      className: \"alt-login-component\",\n      clientId: configurationLogins.google_client_id //CLIENTID NOT CREATED YET\n      ,\n      buttonText: \"LOGIN WITH GOOGLE\",\n      onSuccess: response => this.props.handleAltLogin(\"google\", response),\n      onFailure: response => this.props.handleAltLogin(\"google\", response),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 32\n      }\n    }), /*#__PURE__*/React.createElement(FacebookLogin //className='alt-login-component'\n    , {\n      cssClass: \"alt-login-component alt-login-component-fb\",\n      icon: this.state.icons.facebook,\n      appId: configurationLogins.facebook_api_key //APP ID NOT CREATED YET\n      ,\n      disableMobileRedirect: true,\n      fields: \"name,email,picture\",\n      callback: response => this.props.handleAltLogin(\"facebook\", response),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 33\n      }\n    })))))) : /*#__PURE__*/React.createElement(\"div\", {\n      className: \"Header\",\n      noValidate: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      method: \"post\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"flexColLeft\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      id: \"logo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 25\n      }\n    }, \"Schools.com\"), globalState.startedQuiz !== null ? /*#__PURE__*/React.createElement(\"label\", {\n      style: {\n        color: 'maroon',\n        textDecoration: 'underline',\n        cursor: 'pointer'\n      },\n      onClick: e => window.location.assign(\"https://\" + window.location.hostname + ':' + window.location.port + \"/quizShowSelected/\" + globalState.startedQuiz.id),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 51\n      }\n    }, /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 51\n      }\n    }), globalState.startedQuiz.description, \" started (\", getMinutesRemaining(globalState.startedQuiz.start_time, globalState.startedQuiz.duration_minutes), \" mins left) \") : null), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"flexColRight\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      id: \"loginStatus\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      id: \"HeaderRightLink\",\n      href: \"/\",\n      style: {\n        textDecoration: \"underline\"\n      },\n      onClick: this.logoutUser,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 29\n      }\n    }, \"Logout\"), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 29\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 34\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 39\n      }\n    }), /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 29\n      }\n    }, \"Logged in as: \"), /*#__PURE__*/React.createElement(\"label\", {\n      id: \"userId\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 29\n      }\n    }, globalState.loggedInUserFullName))))));\n  }\n\n}\n\nexport default Header;","map":{"version":3,"sources":["/home/mathew/javascript/ischools-react/client/src/components/Header.js"],"names":["React","Component","FacebookLogin","GoogleLogin","configurationLogins","getMinutesRemaining","data","userIdChange","passwordChange","setErrorMessage","onLogin","onLogout","submitQuiz","Header","constructor","props","handleAltLogin","strSource","response","AltLoginInitiate","firstName","lastName","email","id","picture_url","reqBody","encodeURIComponent","fetch","headers","method","body","then","res","json","errorMessage","loggedInUser","loggedInUserFullName","admin","dispatch","undefined","fullName","name","arrName","split","length","picture","url","googleId","profileObj","imageUrl","givenName","familyName","handleLoginSubmit","event","globalState","state","userId","password","preventDefault","console","log","login","full_name","logoutUser","e","confirmMsg","startedQuiz","description","b","window","confirm","startedQuizAnswers","icons","render","color","textDecoration","cursor","location","assign","hostname","port","start_time","duration_minutes","paddingRight","fontSize","google_client_id","facebook","facebook_api_key"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport FacebookLogin from 'react-facebook-login';\nimport GoogleLogin from 'react-google-login';\nimport configurationLogins from '../ConfigurationLogins'\nimport {getMinutesRemaining} from '../utils/utils';\nimport data from './data';\nimport {userIdChange, passwordChange, setErrorMessage, onLogin, onLogout, submitQuiz} from '../stores/appStoreActions';\n\nclass Header extends Component{\n  constructor(props){\n    super(props);\n    this.state={\n      icons: data.icons\n    }\n  }\n\n  handleAltLogin=(strSource, response)=>{\n    const AltLoginInitiate=(firstName, lastName, email, id, picture_url)=>{\n      var reqBody=\"userId=\"+encodeURIComponent(id);\n      reqBody+='&firstName='+encodeURIComponent(firstName);\n      reqBody+='&lastName='+encodeURIComponent(lastName);\n      reqBody+='&email='+encodeURIComponent(email);\n      reqBody+='&pictureUrl='+encodeURIComponent(picture_url);\n\n      fetch(`/api/mergeUser`, {\n        headers:{\n          'Accept':'application/json',\n          'Content-type': 'application/x-www-form-urlencoded'\n        },\n        method: 'POST',\n        body: reqBody\n      })\n      .then(res=>res.json())\n      .then(data=>{\n          //console.log(data);\n       });\n       onLogin({errorMessage:null,\n                     loggedInUser: id,\n                     loggedInUserFullName: firstName+' '+lastName,\n                     admin: '0'\n                   }, dispatch);\n       //console.log(firstName+' '+lastName+' '+email+' '+id+' '+picture_url);\n    };\n    if(strSource==='facebook' && response.id!==undefined){\n      let fullName=response.name;\n      let firstName=fullName;\n      let lastName=\"\";\n      let arrName=fullName.split(\" \");\n      if(arrName.length>1){\n        firstName=arrName[0];\n        lastName=arrName[1];\n      }\n      let email=response.email;\n      let id=response.id;\n      let picture_url=response.picture.data.url;\n      AltLoginInitiate(firstName, lastName, email, id, picture_url);\n    }\n    else if(strSource==='google' && response.googleId!==undefined){\n      let id=response.googleId;\n      let picture_url=response.profileObj.imageUrl;\n      let email=response.profileObj.email;\n      let firstName=response.profileObj.givenName;\n      let lastName=response.profileObj.familyName;\n      AltLoginInitiate(firstName, lastName, email, id, picture_url);\n      //console.log(response);\n    }\n    //alert(strSource);\n  }\n\n  handleLoginSubmit=(event)=>{\n      let globalState=this.props.state;\n      let dispatch=this.props.dispatch;\n      if(globalState.userId===null\n          ||globalState.password===null\n          ||globalState.password.length===0\n          ||globalState.userId.length===0)\n      {\n        event.preventDefault();\n        setErrorMessage(\"UserId/password cannot be empty\", dispatch);\n        return;\n      }\n      var reqBody=\"userId=\"+encodeURIComponent(globalState.userId);\n          reqBody+='&password='+encodeURIComponent(globalState.password);\n\n          fetch(`/api/login`, {\n            headers:{\n              'Accept':'application/json',\n              'Content-type': 'application/x-www-form-urlencoded'\n            },\n            method: 'POST',\n            body: reqBody\n          })\n          .then(res=>res.json())\n          .then(\n            data=>{\n              console.log(data);\n              if(data.login===\"ok\"){\n                /*localStorage.setItem('loggedInUser', globalState.userId);\n                localStorage.setItem('loggedInUserFullName', data.full_name);\n                localStorage.setItem('admin', data.admin);*/\n                onLogin({errorMessage:null,\n                              loggedInUser: globalState.userId,\n                              loggedInUserFullName: data.full_name,\n                              admin: data.admin\n                            }, dispatch);\n              }\n              else {\n                setErrorMessage(\"Login Failed: UserId/password Mismatch\", dispatch);\n              }\n            }\n          );\n      event.preventDefault();\n\n  }\n\n  logoutUser=(e)=>{\n    //e.preventDefault();\n    let globalState=this.props.state;\n    let dispatch=this.props.dispatch;\n    let confirmMsg='Are you sure you want to logout?';\n    if(globalState.startedQuiz!==null){\n        confirmMsg+='There is an unsubmitted quiz: \\r\\n'+this.state.startedQuiz.description;\n    }\n    let b=window.confirm(confirmMsg)\n    if(b===true){\n      if(globalState.startedQuiz!==null)\n         submitQuiz(globalState, dispatch);\n      /*localStorage.setItem('loggedInUser', '');\n      localStorage.setItem('loggedInUserFullName','');\n      localStorage.setItem('admin', \"0\");\n      localStorage.removeItem('startedQuiz');\n      localStorage.removeItem('startedQuizAnswers');*/\n      onLogout({errorMessage:null, loggedInUser: '', admin:\"0\",\n                      startedQuiz:null, startedQuizAnswers:null}, dispatch);\n    }\n    else{\n      e.preventDefault();\n    }\n  }\n\n  render(){\n        let globalState=this.props.state;\n        let dispatch=this.props.dispatch;\n        return (globalState.loggedInUser===\"\"?(\n              <div className=\"Header\">\n                <form method=\"post\" action=\"login\" onSubmit={(event)=>this.handleLoginSubmit(event)} noValidate>\n                <div className=\"row\">\n                      <div id=\"flexColLeft\">\n                        <span id=\"logo\">Schools.com</span><br/>\n                        {globalState.startedQuiz!==null?\n                                                (\n                                                  <label style={{color:'maroon', textDecoration:'underline', cursor: 'pointer' }}\n                                                  onClick={(e)=>window.location.assign(\"https://\"+window.location.hostname+':'+window.location.port+\"/quizShowSelected/\"+globalState.startedQuiz.id)}>\n                                                  <br/>{globalState.startedQuiz.description} started ({getMinutesRemaining(globalState.startedQuiz.start_time, globalState.startedQuiz.duration_minutes)} mins left) </label>\n                                                 ):null}\n                        <label style={{color:\"red\", paddingRight:\"50px\"}}>{globalState.errorMessage}</label>\n                      </div>\n                      <div id=\"flexColRight\">\n                              <a  id=\"HeaderRightLink\" href='/userInsert'>Register User</a><br/><br/><br/>\n                              <label for=\"userId\">user id</label>\n                              <input type=\"text\" id=\"userName\" name=\"userName\" tabindex=\"1\"\n                                    onChange={(e)=>userIdChange(e, dispatch)} value={globalState.userId}\n                               ></input>\n                               <label for=\"password\">password</label>\n                               <input type=\"password\" id=\"password\" name=\"password\" tabindex=\"2\"\n                                  onChange={(e)=>passwordChange(e, dispatch)} value={globalState.password}\n                               ></input>\n                               <input type=\"submit\" value=\"Login\" tabindex=\"3\"/><br/><br/>\n                               <div class='alt-login-container'>\n                               <GoogleLogin className='alt-login-component'\n                                style={{fontSize:'10pt'}}\n                                className='alt-login-component'\n                                clientId={configurationLogins.google_client_id} //CLIENTID NOT CREATED YET\n                                buttonText=\"LOGIN WITH GOOGLE\"\n                                onSuccess={(response)=>this.props.handleAltLogin(\"google\",response)}\n                                onFailure={(response)=>this.props.handleAltLogin(\"google\",response)}\n                                />\n                                <FacebookLogin\n                                //className='alt-login-component'\n                                 cssClass='alt-login-component alt-login-component-fb'\n                                 icon={this.state.icons.facebook}\n                                 appId={configurationLogins.facebook_api_key} //APP ID NOT CREATED YET\n                                 disableMobileRedirect={true}\n                                 fields=\"name,email,picture\"\n                                 callback={(response)=>this.props.handleAltLogin(\"facebook\",response)}\n                                 />\n                              </div>\n                      </div>\n                </div>\n                </form>\n              </div>\n        ):\n        (\n          <div className=\"Header\" noValidate>\n          <form method=\"post\">\n              <div className=\"row\">\n                    <div id=\"flexColLeft\">\n                        <span id=\"logo\">Schools.com</span>\n                        {globalState.startedQuiz!==null?\n                                                (\n                                                  <label style={{color:'maroon', textDecoration:'underline', cursor: 'pointer' }}\n                                                  onClick={(e)=>window.location.assign(\"https://\"+window.location.hostname+':'+window.location.port+\"/quizShowSelected/\"+globalState.startedQuiz.id)}>\n                                                  <br/>{globalState.startedQuiz.description} started ({getMinutesRemaining(globalState.startedQuiz.start_time, globalState.startedQuiz.duration_minutes)} mins left) </label>\n                                                 ):null}\n                    </div>\n                    <div id=\"flexColRight\">\n                        <span id=\"loginStatus\">\n                            <a id=\"HeaderRightLink\" href=\"/\" style={{textDecoration:\"underline\"}} onClick={this.logoutUser}>Logout</a>\n                            <br/><br/><br/>\n                            <label>Logged in as: </label>\n                            <label id=\"userId\">\n                            {globalState.loggedInUserFullName}\n                            </label>\n                        </span>\n                    </div>\n              </div>\n          </form>\n          </div>\n        ))\n  }\n\n}\n\nexport default Header;\n"]},"metadata":{},"sourceType":"module"}